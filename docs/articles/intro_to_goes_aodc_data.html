<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Intro to GOES AOD Data • MazamaSatelliteUtils</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Intro to GOES AOD Data">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MazamaSatelliteUtils</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.13</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/aod_data_format.html">AOD Data Format</a>
    </li>
    <li>
      <a href="../articles/goes-east_data_quality_limits.html">GOES-East Data Quality Spatial Limits</a>
    </li>
    <li>
      <a href="../articles/grid_sizes.html">Grid Sizes</a>
    </li>
    <li>
      <a href="../articles/intro_to_goes_aodc_data.html">Intro to GOES AOD Data</a>
    </li>
    <li>
      <a href="../articles/intro_to_mazama_satellite_utils.html">Introduction to MazamaSatelliteUtils</a>
    </li>
    <li>
      <a href="../articles/working_with_goes_aodc_rasters.html">Working With GOES AODC Rasters</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Intro to GOES AOD Data</h1>
                        <h4 class="author">Mazama Science</h4>
            
            <h4 class="date">7/30/2019</h4>
      
      
      <div class="hidden name"><code>intro_to_goes_aodc_data.Rmd</code></div>

    </div>

    
    
<div id="aerosol-optical-depth" class="section level2">
<h2 class="hasAnchor">
<a href="#aerosol-optical-depth" class="anchor"></a>Aerosol Optical Depth</h2>
<p>Aerosol optical depth provides a measure of air quality by estimating the amount of particles in a vertical column of the atmosphere. The absorbtion and scattering of certain spectral wavelengths on the atmosphere is fed into aerosol models to determine an AOD value. This number is unitless, but values closer to 0.0 correspond to a cleaner atmosphere while higher values correspond to more hazy conditions. An average AOD for the U.S. is usually around 0.1 and 0.15.</p>
<p>There are several limitations to this method. Sunlight is required for the measurement process, meaning that AOD levels can’t be estimated during nighttime. Additionally, many areas will have no AOD defined due to the reflectance of clouds or snow.</p>
</div>
<div id="aod-source" class="section level2">
<h2 class="hasAnchor">
<a href="#aod-source" class="anchor"></a>AOD Source</h2>
<p>The MazamaSatelliteUtils package uses AOD data provided by the Advanced Baseline Imager (<a href="https://www.goes-r.gov/spacesegment/abi.html">ABI</a>) on board the GOES-16 satellite. This geostationary satellite is positioned to give the ABI a full view of the lower 48 states so that about every 5 minutes the imager can complete a full scan of this region. The measurements of each individual scan are saved to a NetCDF file for that particular period in time.</p>
<p>More on the ABI’s AOD measurement process can be found in the <a href="https://www.star.nesdis.noaa.gov/goesr/product_aero_aod.php">GOES-R aerosol optical depth overview</a> and the <a href="https://www.star.nesdis.noaa.gov/goesr/docs/ATBD/AOD.pdf">ABI AOD algorithm theoretical basis document</a>.</p>
</div>
<div id="netcdf-files" class="section level2">
<h2 class="hasAnchor">
<a href="#netcdf-files" class="anchor"></a>NetCDF Files</h2>
<p>The “Common Data Form” filetype is used for efficient access to multidimensional array-based data such as atmospheric measurements. A typical scan of North America yields around 3 to 4 MB of data. If scans are taken every 5 minutes, a single day would hold about 12 files * 24 hrs * 3 MB = 860 MB in all. Due to this fairly large size, downloading a NetCDF using the <code>MazamaSatelliteUtils</code> package saves the file to a specified data directory from which the contents can be accessed through a file handle.</p>
</div>
<div id="mazamasatelliteutils-setup" class="section level2">
<h2 class="hasAnchor">
<a href="#mazamasatelliteutils-setup" class="anchor"></a>MazamaSatelliteUtils Setup</h2>
<p>Let’s start exploring AOD data with the <code>MazamaSatelliteUtils</code> package. First we’ll give ourselves a case study to focuson though, such as the recent Milepost 97 Fire. This incident was reported on July 24, 2019 about 1 mile southeast of Canyonville, Oregon and is still current as of August 14, 2019. This should provide plenty of data for us to examine in detail.</p>
<p>To begin our analysis, let’s load the <code>MazamaSatelliteUtils</code> package and define a <code>SatelliteDataDir</code>: A directory where all of our NetCDF files will be stored to and read from:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(MazamaSatelliteUtils)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="../reference/setSatelliteDataDir.html">setSatelliteDataDir</a></span>(<span class="st">"~/Data/Satellite"</span>)</a></code></pre></div>
</div>
<div id="downloading-data-and-creating-netcdf-handles" class="section level2">
<h2 class="hasAnchor">
<a href="#downloading-data-and-creating-netcdf-handles" class="anchor"></a>Downloading Data and Creating NetCDF Handles</h2>
<p>We can now start loading in satellite data using the <code><a href="../reference/goesaodc_downloadAOD.html">goesaodc_downloadAOD()</a></code> function. For this we have to provide a datetime to specify which files we want. If the datetime is defined to the hour, then all of the NetCDF files generated in that hour will be downloaded. If just the date is given with no time specified, then all files generated during that entire day will be fetched. In either case, any downloaded files will be stored in the <code>SatelliteDataDir</code> we just defined.</p>
<p>Since downloading many NetCDF files can take a bit of time, for now let’s only gather data for August 1, 2019 at 17:00:00 UTC (10AM PDT).</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">datetime &lt;-<span class="st"> </span>lubridate<span class="op">::</span><span class="kw"><a href="http://lubridate.tidyverse.org/reference/ymd_hms.html">ymd_h</a></span>(<span class="st">"2019-08-01 17"</span>, <span class="dt">tz =</span> <span class="st">"UTC"</span>)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">downloadedFiles &lt;-<span class="st"> </span><span class="kw"><a href="../reference/goesaodc_downloadAOD.html">goesaodc_downloadAOD</a></span>(<span class="st">"G16"</span>, datetime)</a></code></pre></div>
<p>The <code><a href="../reference/goesaodc_downloadAOD.html">goesaodc_downloadAOD()</a></code> function also returns a vector of paths to each downloaded file. However, if a file already exists in the <code>SatelliteDataDir</code> directory then it will not be downloaded again and will not show up in the returned vector. We can see which files are now availible to read by calling <code><a href="../reference/goesaodc_listFiles.html">goesaodc_listFiles()</a></code> on the datetime we specified:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">dateFiles &lt;-<span class="st"> </span><span class="kw"><a href="../reference/goesaodc_listFiles.html">goesaodc_listFiles</a></span>(<span class="st">"G16"</span>, datetime)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(dateFiles)</a></code></pre></div>
<pre><code>##  [1] "OR_ABI-L2-AODC-M6_G16_s20192131701466_e20192131704239_c20192131706505.nc"
##  [2] "OR_ABI-L2-AODC-M6_G16_s20192131706466_e20192131709239_c20192131711561.nc"
##  [3] "OR_ABI-L2-AODC-M6_G16_s20192131711466_e20192131714239_c20192131716548.nc"
##  [4] "OR_ABI-L2-AODC-M6_G16_s20192131716466_e20192131719239_c20192131721506.nc"
##  [5] "OR_ABI-L2-AODC-M6_G16_s20192131721466_e20192131724239_c20192131726554.nc"
##  [6] "OR_ABI-L2-AODC-M6_G16_s20192131726466_e20192131729239_c20192131731576.nc"
##  [7] "OR_ABI-L2-AODC-M6_G16_s20192131731466_e20192131734239_c20192131736514.nc"
##  [8] "OR_ABI-L2-AODC-M6_G16_s20192131736466_e20192131739239_c20192131741522.nc"
##  [9] "OR_ABI-L2-AODC-M6_G16_s20192131741466_e20192131744239_c20192131746521.nc"
## [10] "OR_ABI-L2-AODC-M6_G16_s20192131746466_e20192131749239_c20192131751539.nc"
## [11] "OR_ABI-L2-AODC-M6_G16_s20192131751466_e20192131754239_c20192131756556.nc"
## [12] "OR_ABI-L2-AODC-M6_G16_s20192131756466_e20192131759239_c20192131801513.nc"</code></pre>
<p>In order to read the contents of a NetCDF file we will need a handle to access it by. This can be done by calling <code><a href="../reference/goesaodc_openFile.html">goesaodc_openFile()</a></code> on the dataset filename, so let’s open the first one in our downloaded time range <code>dateFiles[1]</code>:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">nc &lt;-<span class="st"> </span><span class="kw"><a href="../reference/goesaodc_openFile.html">goesaodc_openFile</a></span>(<span class="dt">filename =</span> dateFiles[<span class="dv">1</span>])</a></code></pre></div>
</div>
<div id="reading-through-netcdf-handles" class="section level2">
<h2 class="hasAnchor">
<a href="#reading-through-netcdf-handles" class="anchor"></a>Reading Through NetCDF Handles</h2>
<p>Now that we have a handle to a netCDF file we can freely access readings from any of the variables in the dataset (listed by <code><a href="https://rdrr.io/r/base/names.html">names(nc$var)</a></code>) using the <code>ncvar_get()</code> function from the <code>ncdf4</code> package.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">readings_aod &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(ncdf4<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ncdf4/man/ncvar_get.html">ncvar_get</a></span>(nc, <span class="st">"AOD"</span>))</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(readings_aod))</a></code></pre></div>
<pre><code>## [1] 3750000</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/range.html">range</a></span>(readings_aod, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</a></code></pre></div>
<pre><code>## [1] -2.575025  2.475025</code></pre>
</div>
<div id="aod-and-dqf-data-as-a-tibble" class="section level2">
<h2 class="hasAnchor">
<a href="#aod-and-dqf-data-as-a-tibble" class="anchor"></a>AOD and DQF Data as a Tibble</h2>
<p>For our purposes of mapping AOD values, we can consolidate all the data we need (longitude, latitude, and AOD) and make it even easier to access by forming it into a tibble. The “DQF” variable will be included as well, which represents the data quality flag for each reading. This flag can take one of the four following values:</p>
<ul>
<li>0 - High quality</li>
<li>1 - Medium quality</li>
<li>2 - Low quality</li>
<li>3 - No retrieval flag <a href="https://www.goes-r.gov/products/docs/PUG-L2+-vol5.pdf">source p.295</a>:</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">tb &lt;-<span class="st"> </span><span class="kw"><a href="../reference/goesaodc_createTibble.html">goesaodc_createTibble</a></span>(nc)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(<span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(tb))</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">lon</th>
<th align="right">lat</th>
<th align="right">AOD</th>
<th align="right">DQF</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">-80.08826</td>
<td align="right">49.99957</td>
<td align="right">0.5779620</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="right">-77.53176</td>
<td align="right">49.97392</td>
<td align="right">0.4747786</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="right">-77.50176</td>
<td align="right">49.97373</td>
<td align="right">4.9999731</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="right">-77.47176</td>
<td align="right">49.97353</td>
<td align="right">0.7465692</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="right">-77.41177</td>
<td align="right">49.97314</td>
<td align="right">0.8988398</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="right">-77.38177</td>
<td align="right">49.97295</td>
<td align="right">0.4525083</td>
<td align="right">2</td>
</tr>
</tbody>
</table>
</div>
<div id="working-with-data-as-spatial-points" class="section level2">
<h2 class="hasAnchor">
<a href="#working-with-data-as-spatial-points" class="anchor"></a>Working With Data as Spatial Points</h2>
<p>We can now finally start visualizing this data on geographic maps by creating and plotting spatial points from the AOD readings. Each spatial point represents a single reading from the ABI’s scan, creating a dense grid of measurements taken about 4km from each other. Let’s plot <strong>all</strong> of the points for our datetime now on a world map:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">sp &lt;-<span class="st"> </span><span class="kw"><a href="../reference/goesaodc_createSpatialPoints.html">goesaodc_createSpatialPoints</a></span>(nc, <span class="dt">dqfLevel =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"></a>
<a class="sourceLine" id="cb11-3" data-line-number="3">maps<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/maps/man/map.html">map</a></span>(<span class="st">"world"</span>)</a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="kw"><a href="../reference/goesaodc_plotSpatialPoints.html">goesaodc_plotSpatialPoints</a></span>(sp, <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">cex =</span> <span class="fl">0.1</span>)</a></code></pre></div>
<p><img src="intro_to_goes_aodc_data_files/figure-html/spatialPlot_world-1.png" width="700"></p>
<p>As you can see, only the United States and Mexico have readings defined. The GOES-16 satellite can’t scan beyond the disk visible below its geosynchrous orbit, so let’s zoom in to just the U.S.:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">maps<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/maps/man/map.html">map</a></span>(<span class="dt">database =</span> <span class="st">"state"</span>)</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="kw"><a href="../reference/goesaodc_plotSpatialPoints.html">goesaodc_plotSpatialPoints</a></span>(sp, <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">cex =</span> <span class="fl">0.3</span>)</a></code></pre></div>
<p><img src="intro_to_goes_aodc_data_files/figure-html/spatialPlot_usa-1.png" width="700"></p>
<p>Now that we have a clearer image of the points we can start to understand the AOD values themselves. The <code><a href="../reference/goesaodc_plotSpatialPoints.html">goesaodc_plotSpatialPoints()</a></code> function colors points according to their AOD value by default, but you can switch to DQF coloring by setting the <code>var</code> parameter to “DQF”. Additionally, when creating your spatial points you can also define the <code>dqfLevel</code> which subsets all points that are <em>at and below</em> the given level. Let’s look at the points at level 0 (highest quality):</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">sp_dqf0 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/goesaodc_createSpatialPoints.html">goesaodc_createSpatialPoints</a></span>(nc, <span class="dt">dqfLevel =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb13-2" data-line-number="2"></a>
<a class="sourceLine" id="cb13-3" data-line-number="3">maps<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/maps/man/map.html">map</a></span>(<span class="st">"state"</span>)</a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="kw"><a href="../reference/goesaodc_plotSpatialPoints.html">goesaodc_plotSpatialPoints</a></span>(sp_dqf0, <span class="dt">cex =</span> <span class="fl">0.3</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="intro_to_goes_aodc_data_files/figure-html/spatialPlot_high_quality-1.png" width="700"></p>
<p>As you can see, quite a bit of data has been removed since a good portion was marked as only medium or low quality. At this point let’s zoom in all the way to Oregon to check for signs of the Milepost 97 Fire (including all quality levels). We’ll need to use the <code>MazamaSpatialUtils</code> package to get the spatial data for the state and cull out-of-bounds points:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(MazamaSpatialUtils)</a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/pkg/MazamaSpatialUtils/man/setSpatialDataDir.html">setSpatialDataDir</a></span>(<span class="st">"~/Data/Spatial"</span>)</a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/pkg/MazamaSpatialUtils/man/loadSpatialData.html">loadSpatialData</a></span>(<span class="st">"USCensusStates"</span>)</a>
<a class="sourceLine" id="cb14-4" data-line-number="4"></a>
<a class="sourceLine" id="cb14-5" data-line-number="5">oregon &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/subset.html">subset</a></span>(USCensusStates, stateCode <span class="op">==</span><span class="st"> "OR"</span>)</a>
<a class="sourceLine" id="cb14-6" data-line-number="6">bbox_oregon &lt;-<span class="st"> </span>sp<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/sp/man/bbox.html">bbox</a></span>(oregon)</a>
<a class="sourceLine" id="cb14-7" data-line-number="7">sp_oregon &lt;-<span class="st"> </span><span class="kw"><a href="../reference/goesaodc_createSpatialPoints.html">goesaodc_createSpatialPoints</a></span>(nc, <span class="dt">bbox =</span> bbox_oregon, <span class="dt">dqfLevel =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb14-8" data-line-number="8"></a>
<a class="sourceLine" id="cb14-9" data-line-number="9">lon_mp97 &lt;-<span class="st"> </span><span class="fl">-123.268</span></a>
<a class="sourceLine" id="cb14-10" data-line-number="10">lat_mp97 &lt;-<span class="st"> </span><span class="fl">42.913</span></a>
<a class="sourceLine" id="cb14-11" data-line-number="11"></a>
<a class="sourceLine" id="cb14-12" data-line-number="12"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(oregon)</a>
<a class="sourceLine" id="cb14-13" data-line-number="13"><span class="kw"><a href="../reference/goesaodc_plotSpatialPoints.html">goesaodc_plotSpatialPoints</a></span>(sp_oregon, <span class="dt">cex =</span> <span class="fl">0.3</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb14-14" data-line-number="14"><span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dt">x =</span> lon_mp97, <span class="dt">y =</span> lat_mp97, <span class="dt">pch =</span> <span class="dv">0</span>, <span class="dt">cex =</span> <span class="fl">4.0</span>, <span class="dt">lwd =</span> <span class="fl">1.5</span>, </a>
<a class="sourceLine" id="cb14-15" data-line-number="15">       <span class="dt">col =</span> <span class="st">"darkgreen"</span>)</a></code></pre></div>
<p><img src="intro_to_goes_aodc_data_files/figure-html/spatialPlot_oregon-1.png" width="700"></p>
<p>Now we can start to make out the the scan pattern made by the ABI, which forms a slightly tilted grid of points.</p>
</div>
<div id="rasterizing-spatial-points" class="section level2">
<h2 class="hasAnchor">
<a href="#rasterizing-spatial-points" class="anchor"></a>Rasterizing Spatial Points</h2>
<p>A raster image divides geographic space into uniform pixels or “cells”. A grid is placed over a map and the value of each cell is calculated by aggregating the those of all the spatial points that fall in that region. For example, if 20 points are contained within one grid space, then all their AOD values could be averaged together to determine the resulting AOD of the raster cell. The uniform grid size is defined by the resolution of the raster (in lon/lat degrees) such that higher resolutions reduce cell area and increase the detail and accuracy of the final image.</p>
<p>Rasters provide the benefit of filling in undefined spaces around spatial points while also making it easier to track locations that the ABI might not have made spatial points for.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">rstr &lt;-<span class="st"> </span><span class="kw"><a href="../reference/goesaodc_createRaster.html">goesaodc_createRaster</a></span>(nc, <span class="dt">bbox =</span> bbox_oregon, <span class="dt">res =</span> <span class="fl">0.1</span>, <span class="dt">dqfLevel =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb15-2" data-line-number="2">pal_aod &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/grDevices/colorRamp.html">colorRampPalette</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"lightgoldenrod1"</span>, <span class="st">"red3"</span>))</a>
<a class="sourceLine" id="cb15-3" data-line-number="3">pal_count &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/grDevices/colorRamp.html">colorRampPalette</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"powderblue"</span>, <span class="st">"dodgerblue4"</span>))</a>
<a class="sourceLine" id="cb15-4" data-line-number="4"></a>
<a class="sourceLine" id="cb15-5" data-line-number="5">raster<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span>(rstr<span class="op">$</span>AOD, <span class="dt">col =</span> <span class="kw">pal_aod</span>(<span class="dv">50</span>))</a>
<a class="sourceLine" id="cb15-6" data-line-number="6"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(oregon, <span class="dt">add =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb15-7" data-line-number="7"><span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dt">x =</span> lon_mp97, <span class="dt">y =</span> lat_mp97, <span class="dt">pch =</span> <span class="dv">0</span>, <span class="dt">cex =</span> <span class="fl">4.0</span>, <span class="dt">lwd =</span> <span class="fl">1.5</span>, </a>
<a class="sourceLine" id="cb15-8" data-line-number="8">       <span class="dt">col =</span> <span class="st">"darkgreen"</span>)</a></code></pre></div>
<p><img src="intro_to_goes_aodc_data_files/figure-html/create_raster_highdef-1.png" width="700"></p>
<p>The resolution of the raster is defined by coordinate degrees, so that by setting <code>res</code> to 0.1 every cell will be 0.1 longitudial degrees “wide” and 0.1 latitudial degrees “tall”. However, cell dimensions in meters are not consistent due to how longitude and latitude lines are curved around the Earth. We can approximate the average cell size though by finding the average area of each and then taking the square root of the slightly rectangular regions. The <code><a href="https://rdrr.io/pkg/raster/man/area.html">raster::area()</a></code> function estimates the area of each cell in km²:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">avgCellArea &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(raster<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/raster/man/getValues.html">values</a></span>(raster<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/raster/man/area.html">area</a></span>(rstr)))</a></code></pre></div>
<p>Just for a sanity check, we can make a rough guess of the size of Oregon state using the average cell area of 88.4546846 km² and the number of cells in the bounding box (3483). This yields 3.080876710^{5} km², which isn’t to far off from the offical state area of 255,030 km².</p>
<p>The square root of the mean cell area is 9.4050351. So for a raster of Oregon with a resolution of 0.1, each cell is about 9.4050351 km on each side.</p>
<p>By zooming in even closer to MilePost 97 we can actually see how these cells are defined by the spatial points they contain. Here, cells are colored by the number of points that fall within them:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">bbox_mp97 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="dv">124</span>, <span class="dv">-123</span>, <span class="fl">42.5</span>, <span class="fl">43.5</span>)</a>
<a class="sourceLine" id="cb17-2" data-line-number="2">pointCoords_mb97 &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(tb, </a>
<a class="sourceLine" id="cb17-3" data-line-number="3">                                  lon <span class="op">&gt;</span><span class="st"> </span>bbox_mp97[<span class="dv">1</span>], lon <span class="op">&lt;</span><span class="st"> </span>bbox_mp97[<span class="dv">2</span>], </a>
<a class="sourceLine" id="cb17-4" data-line-number="4">                                  lat <span class="op">&gt;</span><span class="st"> </span>bbox_mp97[<span class="dv">3</span>], lat <span class="op">&lt;</span><span class="st"> </span>bbox_mp97[<span class="dv">4</span>])</a>
<a class="sourceLine" id="cb17-5" data-line-number="5"></a>
<a class="sourceLine" id="cb17-6" data-line-number="6">rstrCount &lt;-<span class="st"> </span><span class="kw"><a href="../reference/goesaodc_createRaster.html">goesaodc_createRaster</a></span>(nc, <span class="dt">bbox =</span> bbox_oregon, <span class="dt">res =</span> <span class="fl">0.1</span>, </a>
<a class="sourceLine" id="cb17-7" data-line-number="7">                                   <span class="dt">fun =</span> <span class="st">"count"</span>, <span class="dt">dqfLevel =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb17-8" data-line-number="8">raster<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span>(rstrCount<span class="op">$</span>AOD, <span class="dt">main =</span> <span class="st">"Cell Point Count"</span>, <span class="dt">col =</span> <span class="kw">pal_count</span>(<span class="dv">50</span>),</a>
<a class="sourceLine" id="cb17-9" data-line-number="9">             <span class="dt">xlim =</span> bbox_mp97[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], <span class="dt">ylim =</span> bbox_mp97[<span class="dv">3</span><span class="op">:</span><span class="dv">4</span>])</a>
<a class="sourceLine" id="cb17-10" data-line-number="10"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(oregon, <span class="dt">add =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb17-11" data-line-number="11"><span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(pointCoords_mb97<span class="op">$</span>lon, pointCoords_mb97<span class="op">$</span>lat, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> <span class="fl">0.3</span>)</a>
<a class="sourceLine" id="cb17-12" data-line-number="12"><span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(lon_mp97, lat_mp97, <span class="dt">pch =</span> <span class="dv">3</span>, <span class="dt">cex =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="st">"red"</span>)</a></code></pre></div>
<p><img src="intro_to_goes_aodc_data_files/figure-html/unnamed-chunk-1-1.png" width="700"></p>
<p>Given that the average distance between spatial points is about 4km, we can confirm our cell size estimation since these appear to be 2 points wide (8km) and about 3 tall (12km).</p>
</div>
<div id="aod-over-time" class="section level2">
<h2 class="hasAnchor">
<a href="#aod-over-time" class="anchor"></a>AOD Over Time</h2>
<div id="raster-stacks" class="section level3">
<h3 class="hasAnchor">
<a href="#raster-stacks" class="anchor"></a>Raster Stacks</h3>
<p>So far we have only looked at a single instant from our original datetime. There are still 11 other datasets from 16:00:00 that we can analyze like we did this one, but it’s also possible to start combining data into either aggregated rasters or time series plots. In both cases we first create a stack of rasters by, again, defining an hour or date of interest. Let’s stay with our current hour:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">rstrStack &lt;-<span class="st"> </span><span class="kw"><a href="../reference/goesaodc_createRasterStack.html">goesaodc_createRasterStack</a></span>(</a>
<a class="sourceLine" id="cb18-2" data-line-number="2">  <span class="dt">satID =</span> <span class="st">"G16"</span>, </a>
<a class="sourceLine" id="cb18-3" data-line-number="3">  <span class="dt">datetime =</span> datetime,</a>
<a class="sourceLine" id="cb18-4" data-line-number="4">  <span class="dt">bbox =</span> bbox_oregon, </a>
<a class="sourceLine" id="cb18-5" data-line-number="5">  <span class="dt">dqfLevel =</span> <span class="dv">3</span>,</a>
<a class="sourceLine" id="cb18-6" data-line-number="6">  <span class="dt">res =</span> <span class="fl">0.08</span>)</a></code></pre></div>
<p>This raster stack now contains individual layers for each downloaded dataset. We can visualize them all at once using the <code>rasterVis</code> package:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">rasterVis<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/rasterVis/man/levelplot-methods.html">levelplot</a></span>(rstrStack)</a></code></pre></div>
<p><img src="intro_to_goes_aodc_data_files/figure-html/rasterStack_levelPlot-1.png" width="768"></p>
<p>Additionally, one can aggregate all of the rasters together to make one summarizing image, such as finding the mean AOD value for every pixel between scans.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">rstrStackAvg &lt;-<span class="st"> </span>raster<span class="op">::</span><span class="kw">mean</span>(rstrStack, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb20-2" data-line-number="2">raster<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span>(rstrStackAvg, <span class="dt">col =</span> <span class="kw">pal_aod</span>(<span class="dv">50</span>))</a>
<a class="sourceLine" id="cb20-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(oregon, <span class="dt">add =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb20-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dt">x =</span> lon_mp97, <span class="dt">y =</span> lat_mp97, <span class="dt">pch =</span> <span class="dv">0</span>, <span class="dt">cex =</span> <span class="fl">4.0</span>, <span class="dt">lwd =</span> <span class="fl">1.5</span>, </a>
<a class="sourceLine" id="cb20-5" data-line-number="5">       <span class="dt">col =</span> <span class="st">"darkgreen"</span>)</a></code></pre></div>
<p><img src="intro_to_goes_aodc_data_files/figure-html/rasterStack_average-1.png" width="700"></p>
</div>
<div id="hourly-time-series-plots" class="section level3">
<h3 class="hasAnchor">
<a href="#hourly-time-series-plots" class="anchor"></a>Hourly Time Series Plots</h3>
<p>Finally, the <code><a href="../reference/raster_createLocationTimeseries.html">raster_createLocationTimeseries()</a></code> function allows us to track AOD values of a specific location in each layer of a stack, resulting in a tibble of AOD values and their timestamps. There are a couple of ways of extracting this location data, however. The default method is to track the one cell that the given coordinates fall into, chosen by setting the <code>method</code> parameter to “simple”. Additionally, one can set <code>method</code> to “bilinear”, and track the AOD interpolated between the 4 closest cells.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">datetimeLocal &lt;-<span class="st"> </span>datetime</a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/attributes.html">attributes</a></span>(datetimeLocal)<span class="op">$</span>tzone =<span class="st"> "America/Los_Angeles"</span></a>
<a class="sourceLine" id="cb21-3" data-line-number="3"></a>
<a class="sourceLine" id="cb21-4" data-line-number="4">ts_simple &lt;-<span class="st"> </span><span class="kw"><a href="../reference/raster_createLocationTimeseries.html">raster_createLocationTimeseries</a></span>(<span class="dt">rasterStack =</span> rstrStack,</a>
<a class="sourceLine" id="cb21-5" data-line-number="5">                                             <span class="dt">longitude =</span> lon_mp97, </a>
<a class="sourceLine" id="cb21-6" data-line-number="6">                                             <span class="dt">latitude =</span> lat_mp97, </a>
<a class="sourceLine" id="cb21-7" data-line-number="7">                                             <span class="dt">bbox =</span> bbox_oregon,</a>
<a class="sourceLine" id="cb21-8" data-line-number="8">                                             <span class="dt">method =</span> <span class="st">"simple"</span>)</a>
<a class="sourceLine" id="cb21-9" data-line-number="9"></a>
<a class="sourceLine" id="cb21-10" data-line-number="10"><span class="kw"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="dt">mfrow=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb21-11" data-line-number="11">raster<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span>(rstrStackAvg, <span class="dt">col =</span> <span class="kw">pal_aod</span>(<span class="dv">50</span>), </a>
<a class="sourceLine" id="cb21-12" data-line-number="12">             <span class="dt">xlim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="dv">125</span>, <span class="dv">-122</span>), <span class="dt">ylim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">42</span>, <span class="dv">44</span>),</a>
<a class="sourceLine" id="cb21-13" data-line-number="13">             <span class="dt">main =</span> <span class="st">"Milepost 97 AOD"</span>, </a>
<a class="sourceLine" id="cb21-14" data-line-number="14">             <span class="dt">xlab =</span> <span class="st">"Longitude"</span>, <span class="dt">ylab =</span> <span class="st">"Latitude"</span>)</a>
<a class="sourceLine" id="cb21-15" data-line-number="15"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(oregon, <span class="dt">add =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb21-16" data-line-number="16"><span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dt">x =</span> lon_mp97, <span class="dt">y =</span> lat_mp97, <span class="dt">pch =</span> <span class="dv">3</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb21-17" data-line-number="17"></a>
<a class="sourceLine" id="cb21-18" data-line-number="18"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="dt">x =</span> ts_simple<span class="op">$</span>datetime, <span class="dt">y =</span> ts_simple<span class="op">$</span>aod, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb21-19" data-line-number="19">     <span class="dt">main =</span> <span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(datetimeLocal, <span class="st">"PDT"</span>), <span class="dt">xlab =</span> <span class="st">"Time (local)"</span>, <span class="dt">ylab =</span> <span class="st">"AOD"</span>)</a></code></pre></div>
<p><img src="intro_to_goes_aodc_data_files/figure-html/timeseries_method-1.png" width="1056"></p>
<p>Aside from the two <code>method</code> options, we can instead define a <code>buffer</code>, which is a circular area around our location that will aggregate the values of cells that fall within it. Provide the <code>buffer</code>radius in meters and a <code>fun</code> aggregation method such as mean, min, or max. <code>fun</code> is set to mean by default.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">ts_buffer &lt;-<span class="st"> </span><span class="kw"><a href="../reference/raster_createLocationTimeseries.html">raster_createLocationTimeseries</a></span>(<span class="dt">rasterStack =</span> rstrStack,</a>
<a class="sourceLine" id="cb22-2" data-line-number="2">                                             <span class="dt">longitude =</span> lon_mp97,</a>
<a class="sourceLine" id="cb22-3" data-line-number="3">                                             <span class="dt">latitude =</span> lat_mp97, </a>
<a class="sourceLine" id="cb22-4" data-line-number="4">                                             <span class="dt">bbox =</span> bbox_oregon,</a>
<a class="sourceLine" id="cb22-5" data-line-number="5">                                             <span class="dt">buffer =</span> <span class="dv">20000</span>,</a>
<a class="sourceLine" id="cb22-6" data-line-number="6">                                             <span class="dt">fun =</span> mean)</a>
<a class="sourceLine" id="cb22-7" data-line-number="7"></a>
<a class="sourceLine" id="cb22-8" data-line-number="8"><span class="kw"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="dt">mfrow=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb22-9" data-line-number="9">raster<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span>(rstrStackAvg, <span class="dt">col =</span> <span class="kw">pal_aod</span>(<span class="dv">50</span>), </a>
<a class="sourceLine" id="cb22-10" data-line-number="10">             <span class="dt">xlim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="dv">125</span>, <span class="dv">-122</span>), <span class="dt">ylim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">42</span>, <span class="dv">44</span>),</a>
<a class="sourceLine" id="cb22-11" data-line-number="11">             <span class="dt">main =</span> <span class="st">"Milepost 97 AOD"</span>, </a>
<a class="sourceLine" id="cb22-12" data-line-number="12">             <span class="dt">xlab =</span> <span class="st">"Longitude"</span>, <span class="dt">ylab =</span> <span class="st">"Latitude"</span>)</a>
<a class="sourceLine" id="cb22-13" data-line-number="13"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(oregon, <span class="dt">add =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb22-14" data-line-number="14"><span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dt">x =</span> lon_mp97, <span class="dt">y =</span> lat_mp97, <span class="dt">pch =</span> <span class="dv">1</span>, <span class="dt">lwd =</span> <span class="fl">0.5</span>, <span class="dt">cex =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb22-15" data-line-number="15"><span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="dt">x =</span> lon_mp97, <span class="dt">y =</span> lat_mp97, <span class="dt">pch =</span> <span class="dv">3</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb22-16" data-line-number="16"></a>
<a class="sourceLine" id="cb22-17" data-line-number="17"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="dt">x =</span> ts_buffer<span class="op">$</span>datetime, <span class="dt">y =</span> ts_buffer<span class="op">$</span>aod, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb22-18" data-line-number="18">     <span class="dt">main =</span> <span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(datetimeLocal, <span class="st">"PDT"</span>), <span class="dt">xlab =</span> <span class="st">"Time (local)"</span>, <span class="dt">ylab =</span> <span class="st">"AOD"</span>)</a></code></pre></div>
<p><img src="intro_to_goes_aodc_data_files/figure-html/timeseries_buffer-1.png" width="1056"></p>
</div>
<div id="daily-time-series-plots" class="section level3">
<h3 class="hasAnchor">
<a href="#daily-time-series-plots" class="anchor"></a>Daily Time Series Plots</h3>
<p>A time series plot with only 12 points isn’t especially useful, though it can help show the trend of the AOD values over a portion of a day. We are currently building a function that can create a raster stack for every daylight hour for a given date, which has provided some very interesting insight so far!</p>
<p><img src="img/aod_ts_day.png"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#aerosol-optical-depth">Aerosol Optical Depth</a></li>
      <li><a href="#aod-source">AOD Source</a></li>
      <li><a href="#netcdf-files">NetCDF Files</a></li>
      <li><a href="#mazamasatelliteutils-setup">MazamaSatelliteUtils Setup</a></li>
      <li><a href="#downloading-data-and-creating-netcdf-handles">Downloading Data and Creating NetCDF Handles</a></li>
      <li><a href="#reading-through-netcdf-handles">Reading Through NetCDF Handles</a></li>
      <li><a href="#aod-and-dqf-data-as-a-tibble">AOD and DQF Data as a Tibble</a></li>
      <li><a href="#working-with-data-as-spatial-points">Working With Data as Spatial Points</a></li>
      <li><a href="#rasterizing-spatial-points">Rasterizing Spatial Points</a></li>
      <li><a href="#aod-over-time">AOD Over Time</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Jonathan Callahan, Helen Miller, Raffuse Sean, Rex Thompson, Tate Brasel, Thomas Bergamaschi, Roger Andre.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
