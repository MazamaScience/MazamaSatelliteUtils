<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kincade Fire Example • MazamaSatelliteUtils</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Kincade Fire Example">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">MazamaSatelliteUtils</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.13</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/articles/Kincade_Fire_Example.html">Kincade Fire Example</a>
    </li>
    <li>
      <a href="../../articles/articles/Milepost_97_example.html">Milepost 97 Example</a>
    </li>
    <li>
      <a href="../../articles/articles/aod_data_format.html">AOD Data Format</a>
    </li>
    <li>
      <a href="../../articles/articles/aod_data_structures.html">Working with AODC Data Structures</a>
    </li>
    <li>
      <a href="../../articles/articles/goes-east_data_quality_limits.html">GOES-East Data Quality Spatial Limits</a>
    </li>
    <li>
      <a href="../../articles/articles/grid_sizes.html">Grid Sizes</a>
    </li>
    <li>
      <a href="../../articles/articles/working_with_goes_aodc_rasters.html">Working With GOES AODC Rasters</a>
    </li>
    <li>
      <a href="../../articles/articles/working_with_mazma_satellite_utils.html">Working with Mazama Satellite Utils</a>
    </li>
    <li>
      <a href="../../articles/intro_to_mazama_satellite_utils.html">Introduction to MazamaSatelliteUtils</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Kincade Fire Example</h1>
                        <h4 class="author">Mazama Science</h4>
            
            <h4 class="date">1/9/2020</h4>
      
      
      <div class="hidden name"><code>Kincade_Fire_Example.Rmd</code></div>

    </div>

    
    
<p>The Kincade Fire, which burned in Sonoma County from October 23 to November 6, was the largest wildfire in California during 2019 and the largest fire ever in Sonoma County. This example will show the smoke movement from this fire during the day on October 29, 2019 using the <em>MazamaSatelliteUtils</em> R package. In it, we will check for data on the server, download it, visualize it in several ways and finally create a movie which shows smoke movement during the day.</p>
<div class="figure">
<img src="img/2019_10_29_kincade_fire_sat_image.png" alt="10/29/2020 Satellite Image of Kincade Fire"><p class="caption">10/29/2020 Satellite Image of Kincade Fire</p>
</div>
<div id="setup-work-environment" class="section level3">
<h3 class="hasAnchor">
<a href="#setup-work-environment" class="anchor"></a>Setup Work Environment</h3>
<p>In order to analyze the AOD levels for the Daytime period on Oct 29, a great many files will need to be downloaded and processed. It will be beneficial to specify a project directory for this particular project, where only data pertaining to this specific date and location is stored.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(MazamaSatelliteUtils)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(MazamaSpatialUtils)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw"><a href="../../reference/setSatelliteDataDir.html">setSatelliteDataDir</a></span>(<span class="st">"~/Data/kincade"</span>)</a></code></pre></div>
</div>
<div id="check-data-availability" class="section level3">
<h3 class="hasAnchor">
<a href="#check-data-availability" class="anchor"></a>Check Data Availability</h3>
<p>GOES-West AOD data became available from the BlueSky/Fire site beginning on August 28, 2019. In order to have a sense of how much data we will need to obtain for this project, our first step will be to check on the Fire server to see what AOD data is available on that day. Furthermore, as we are only interested in seeing what data is available during local daytime hours in Sonoma, CA, we will limit our file-listing to only Daytime hours.</p>
<pre><code>goesaodc_listDaytimeFiles(satID = "G17", 
                          datetime = "2019-10-29", 
                          timezone = "America/Los_Angeles", 
                          useRemote = TRUE)
  
  [1] "OR_ABI-L2-AODC-M6_G17_s20193021401196_e20193021403569_c20193021404452.nc"
  [2] "OR_ABI-L2-AODC-M6_G17_s20193021406196_e20193021408569_c20193021409556.nc"
  [3] "OR_ABI-L2-AODC-M6_G17_s20193021411196_e20193021413569_c20193021414550.nc"
  [4] "OR_ABI-L2-AODC-M6_G17_s20193021416196_e20193021418569_c20193021419500.nc"
  [5] "OR_ABI-L2-AODC-M6_G17_s20193021421196_e20193021423569_c20193021424570.nc"
  [6] "OR_ABI-L2-AODC-M6_G17_s20193021426196_e20193021428569_c20193021429586.nc"
  [7] "OR_ABI-L2-AODC-M6_G17_s20193021431196_e20193021433569_c20193021434537.nc"
  &lt;snip&gt;
    [138] "OR_ABI-L2-AODC-M6_G17_s20193030126196_e20193030128569_c20193030130466.nc"
  [139] "OR_ABI-L2-AODC-M6_G17_s20193030131196_e20193030133569_c20193030135512.nc"
  [140] "OR_ABI-L2-AODC-M6_G17_s20193030136196_e20193030138569_c20193030141011.nc"
  [141] "OR_ABI-L2-AODC-M6_G17_s20193030141196_e20193030143569_c20193030145552.nc"
  [142] "OR_ABI-L2-AODC-M6_G17_s20193030146196_e20193030148569_c20193030151118.nc"
  [143] "OR_ABI-L2-AODC-M6_G17_s20193030151196_e20193030153569_c20193030156149.nc"
  [144] "OR_ABI-L2-AODC-M6_G17_s20193030156196_e20193030158569_c20193030201120.nc"</code></pre>
<p>As we can see from the date strings in the truncated file listing output above, there are 144 files available during the Daytime hours of October 29th. These files span the datetimes from <em>s20193021401196</em> until <em>e20193030158569</em>. Some explanation about how to read these date strings is shown here.</p>
<pre><code>  s20193021401196...
  s    = "start"
  2019 = Year
  302  = Ordinal Day
  14   = 24hr Day Hour
  01   = Minute
  19   = Seconds 
  6    = Milliseconds
  
  e20193030158569...
  e     = "end"
  2019  = Year
  303   = Ordinal Day
  01    = 24hr Day Hour
  58    = Minutes
  56    = Seconds
  9     = Milliseconds</code></pre>
<p>In other words, the files needed to display AOD during Daytime hours span from roughly <em>2019-10-29 14:00 UTC</em> until <em>2019-10-30 01:00 UTC</em>. <code><a href="../../reference/goesaodc_listDaytimeFiles.html">goesaodc_listDaytimeFiles()</a></code> automatically took the input date of “2019-10-29” and the Olson timezone of “America/Los_Angeles” and performed the calculations needed to obtain the Sunrise and Sunset times for that timezone on that date. We can verify those times using the <code><a href="../../reference/getDaylightHours.html">getDaylightHours()</a></code> utility function that is included in the package.</p>
<pre><code>getDaylightHours(datetime = "2019-10-29", timezone = "America/Los_Angeles")
$sunrise
[1] "2019-10-29 07:02:54 PDT"
  
$sunset
[1] "2019-10-29 18:18:57 PDT"</code></pre>
<p>And when we convert those times back into UTC, we see that we match the start and end times of our available files.</p>
<pre><code>start &lt;- MazamaCoreUtils::parseDatetime("2019-10-29 07:02:54", timezone = "America/Los_Angeles")
end &lt;- MazamaCoreUtils::parseDatetime("2019-10-29 18:18:57", timezone = "America/Los_Angeles")
  
lubridate::with_tz(start, tzone = "UTC")
[1] "2019-10-29 14:02:54 UTC"

lubridate::with_tz(end, tzone = "UTC")
[1] "2019-10-30 01:18:57 UTC"</code></pre>
<p><strong>NOTE:</strong> It is important to remember that <strong>MazamaSatelliteUtils</strong> uses the entire hour as it’s base unit of time.</p>
</div>
<div id="download-the-data" class="section level3">
<h3 class="hasAnchor">
<a href="#download-the-data" class="anchor"></a>Download the Data</h3>
<p>Downloading the AOD data for our timespan of interest can be easily accomplished by using the <code><a href="../../reference/goesaodc_downloadDaytimeAOD.html">goesaodc_downloadDaytimeAOD()</a></code> function, which works very similarly to <code><a href="../../reference/goesaodc_listDaytimeFiles.html">goesaodc_listDaytimeFiles()</a></code>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw"><a href="../../reference/goesaodc_downloadDaytimeAOD.html">goesaodc_downloadDaytimeAOD</a></span>(<span class="dt">satID =</span> <span class="st">"G17"</span>, </a>
<a class="sourceLine" id="cb6-2" data-line-number="2">                            <span class="dt">datetime =</span> <span class="st">"2019-10-29"</span>, </a>
<a class="sourceLine" id="cb6-3" data-line-number="3">                            <span class="dt">timezone =</span> <span class="st">"America/Los_Angeles"</span>, </a>
<a class="sourceLine" id="cb6-4" data-line-number="4">                            <span class="dt">verbose =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb6-5" data-line-number="5"></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">#Downloaded OR_ABI-L2-AODC-M6_G17_s20193021401196_e20193021403569_c20193021404452.nc</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">#Downloaded OR_ABI-L2-AODC-M6_G17_s20193021406196_e20193021408569_c20193021409556.nc</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">#Downloaded OR_ABI-L2-AODC-M6_G17_s20193021411196_e20193021413569_c20193021414550.nc</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">#&lt;snip&gt;</span></a></code></pre></div>
<p><strong>NOTE:</strong> By default the download function does not show the filenames being downloaded. The “verbose” parameter must be set to “TRUE” in order for them to display.</p>
<p>An alternative method to download the files would be to use the core <code><a href="../../reference/goesaodc_downloadAOD.html">goesaodc_downloadAOD()</a></code> function with a time range that corresponds to the Daylight hours obtained earlier using <code><a href="../../reference/getDaylightHours.html">getDaylightHours()</a></code>. An example of this method is shown below, as it is a useful way to obtain a smaller range of time than a full day.</p>
<center>
<strong>Example of AOD download using starting and ending times</strong>
</center>
<pre><code><a href="../../reference/goesaodc_downloadAOD.html">goesaodc_downloadAOD(satID = "G17", datetime = "2019-10-29 07", endTime = "2019-10-29 18", timezone = "America/Los_Angeles")</a></code></pre>
</div>
<div id="verify-files-have-downloaded" class="section level3">
<h3 class="hasAnchor">
<a href="#verify-files-have-downloaded" class="anchor"></a>Verify Files Have Downloaded</h3>
<p>Whichever way you’ve decided to download the files, it’s now a good idea to make sure that you’ve downloaded the data that you think you have. This is particularly a good idea if you have done the download without specifying “verbose = TRUE”. If we use <code><a href="../../reference/goesaodc_listDaytimeFiles.html">goesaodc_listDaytimeFiles()</a></code> in it’s default mode, with <code>useRemote = FALSE</code>, we can confirm that we have 144 files downloaded and residing in our project directory, which we set using <code>setSatteliteDataDir</code>.</p>
<pre><code>goesaodc_listDaytimeFiles(satID = "G17", 
                          datetime = "2019-10-29", 
                          timezone = "America/Los_Angeles")
&lt;snip&gt;
[140] "OR_ABI-L2-AODC-M6_G17_s20193030136196_e20193030138569_c20193030141011.nc"
[141] "OR_ABI-L2-AODC-M6_G17_s20193030141196_e20193030143569_c20193030145552.nc"
[142] "OR_ABI-L2-AODC-M6_G17_s20193030146196_e20193030148569_c20193030151118.nc"
[143] "OR_ABI-L2-AODC-M6_G17_s20193030151196_e20193030153569_c20193030156149.nc"
[144] "OR_ABI-L2-AODC-M6_G17_s20193030156196_e20193030158569_c20193030201120.nc"</code></pre>
</div>
<div id="first-look-at-data" class="section level3">
<h3 class="hasAnchor">
<a href="#first-look-at-data" class="anchor"></a>First Look at Data</h3>
<p>There are a variety of ways to visualize the AOD data, but for now, it’s handy to just have a look at a single snapshot of the data. To do that, we select a file from the set we downloaded earlier, crop it to the area near Santa Rosa, CA, and have a look at it. But first we run <code><a href="../../reference/installGoesGrids.html">installGoesGrids()</a></code> to create the spatial grids that will be used to tie the pixel data from the satellite image to points on the ground</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw"><a href="../../reference/installGoesGrids.html">installGoesGrids</a></span>()</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">nc_file &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/goesaodc_listFiles.html">goesaodc_listFiles</a></span>(<span class="dt">satID =</span> <span class="st">"G17"</span>, </a>
<a class="sourceLine" id="cb9-3" data-line-number="3">                                     <span class="dt">datetime =</span> <span class="st">"2019-10-29 10"</span>, </a>
<a class="sourceLine" id="cb9-4" data-line-number="4">                                     <span class="dt">timezone =</span> <span class="st">"America/Los_Angeles"</span>)[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb9-5" data-line-number="5">nc_handle &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/goesaodc_openFile.html">goesaodc_openFile</a></span>(nc_file)</a>
<a class="sourceLine" id="cb9-6" data-line-number="6"></a>
<a class="sourceLine" id="cb9-7" data-line-number="7">kincade_bbox &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="dv">125</span>, <span class="dv">-120</span>, <span class="dv">36</span>, <span class="dv">40</span>)</a>
<a class="sourceLine" id="cb9-8" data-line-number="8"></a>
<a class="sourceLine" id="cb9-9" data-line-number="9"><span class="kw"><a href="../../reference/goesaodc_areaPlot.html">goesaodc_areaPlot</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(nc_handle), kincade_bbox)</a></code></pre></div>
<p><img src="Kincade_Fire_Example_files/figure-html/first_view-1.png" width="672" style="display: block; margin: auto;"></p>
<p>We can clearly see the heavy smoke plume coming out of the Santa Rosa region towards the Southwest, as well as dense smoke that is drifting throughout the rest of the Bay Area.</p>
</div>
<div id="create-a-movie-from-data" class="section level3">
<h3 class="hasAnchor">
<a href="#create-a-movie-from-data" class="anchor"></a>Create a movie from data</h3>
<p>It’s relatively straight-forward to create a movie of the AOD changes throught the day. Use the <code>createSpatialPointsVideo_exec.R</code> file located in <em>local_executables</em>. It requires that <a href="https://www.ffmpeg.org/">ffmpeg</a> be installed. To create the movie, execute the following command:</p>
<pre><code>./createSpatialPointsVideo_exec.R --datetime="2019-10-29" \
-s CA -x AOD -q 3 -r 2 -o ~/Desktop/ -v TRUE \
--SpatialDataDir="~/Data/Spatial" \
--SatelliteDataDir="~/Data/kincade" \
--bbox="-124, -120, 36.5, 40.5" \
--fullDay="TRUE"</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Jonathan Callahan, Helen Miller, Raffuse Sean, Rex Thompson, Tate Brasel, Thomas Bergamaschi, Roger Andre.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
